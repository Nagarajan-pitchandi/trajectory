function sol =cubic(thetaini,thetafin,tf)
ti=0;
t=ti:.1:tf;
c11=0;
c12=0;
c13=0;
c01=thetaini(1);
c02=thetaini(2);
c03=thetaini(3);
T=[tf^2 tf^3;2*tf 3*tf^2];
u=thetafin(1)-thetaini(1);
v=thetafin(2)-thetaini(2);
w=thetafin(3)-thetaini(3);
[C]=inv(T)*[u;0];
[D]=inv(T)*[v;0];
[E]=inv(T)*[w;0];
c21=C(1);
c31=C(2);
c22=D(1);
c32=D(2);
c23=E(1);
c33=E(2);
for k=1:length(t)
    theta(1,k)=c01+c11*t(k)+c21*t(k)^2+c31*t(k)^3;
    theta(2,k)=c02+c12*t(k)+c22*t(k)^2+c32*t(k)^3;
    theta(3,k)=c03+c13*t(k)+c23*t(k)^2+c33*t(k)^3;
    vel(1,k)=c11+2*c21*t(k)+3*c31*t(k)^2;
    vel(2,k)=c12+2*c22*t(k)+3*c32*t(k)^2;
    vel(3,k)=c13+2*c23*t(k)+3*c33*t(k)^2;
    acc(1,k)=2*c21+6*c31*t(k);
    acc(2,k)=2*c22+6*c32*t(k);
    acc(3,k)=2*c23+6*c33*t(k);
end
theta1t=theta(1,:)';
theta2t=theta(2,:)';
theta3t=theta(3,:)';
vel1t=vel(1,:)';
vel2t=vel(2,:)';
vel3t=vel(3,:)';
sol=[theta1t theta2t theta3t];
end